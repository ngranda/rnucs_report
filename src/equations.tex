\section{Nuclide concetration equations}
This section is primarily to write out equations that might be
important to include when talking about the mesh radionuclide
workflow. 
%%
%%
The rate of change of nuclear concentration is given by
\begin{equation}\label{eq:nuclide_conc_rc}
    \frac{dN_{i}(t)}{dt} = \sum_{j} N_{j}(t)P_{j \rightarrow i, total}
    - \sum_{j} N_{i}(t)P_{i \rightarrow j, total}
\end{equation}
%%
%%
For multiple nuclides this becomes a system of differential equations and
can be represented in the following notation
\begin{equation}\label{eq:nuclide_conc_rc_vec}
  \frac{d\vec{N}(t)}{dt} =\boldsymbol{A}  \vec{N}(t)
\end{equation}
%%
%%
A solution to the system of differential equations is given by equation \ref{eq:rate_change_sol}
\begin{equation}\label{eq:rate_change_sol}
  \vec{N}(t) =\vec{N}_{o} e^{\boldsymbol{A}t}
\end{equation}
A way to solve Equation \ref{eq:rate_change_sol} is to break the transmutation network
into a collection of linear chains so that each isotope has one production term and
one destruction term making the $\boldsymbol{A}$ matrix bidiagonal allowing a solution
in the form of the Bateman Equation.
\begin{equation}\label{eq:bateman}
  N_{i}(t) = \sum_{j=1}^{i} N_{j}(0)
  \Bigg[ \Bigg( \prod_{k=j}^{i-1} P_{k} \Bigg)
  \sum_{k=j}^{i}\frac{e^{-d_{k}t}}{\displaystyle \prod_{l=j,\neq k}^{i}(d_{l} -d_{k})}
  \Bigg]
\end{equation}
where $d$ represents the destruction term and $P$ the production ter term
%%
%%
When there is not nuclear data availble, like is the case for high energy interactions,
another term is introduced in Equation \ref{eq:nuclide_conc_rc}. This term is a
production rate constant.
\begin{equation}\label{eq:nuclide_conc_rc_he}
    \frac{dN_{i}(t)}{dt} = \sum_{j} N_{j}(t)P_{j \rightarrow i, total}
    - \sum_{j} N_{i}(t)P_{i \rightarrow j, total} + Y_{i}
\end{equation}
%%
%%
The system of differential equations can be represented by
Equation \ref{eq:nuclide_conc_rc_vec_he}
\begin{equation}\label{eq:nuclide_conc_rc_vec_he}
  \frac{d\vec{N}(t)}{dt} =\boldsymbol{A}  \vec{N}(t) + \vec{Y}
\end{equation}
%%
%%
A general solution to Equation \ref{eq:nuclide_conc_rc_vec_he} is given below
\begin{equation}\label{eq:rate_change_sol_he}
  \vec{N}(t) =\vec{N}_{o} e^{\boldsymbol{A}t }- \boldsymbol{A^{-1}} \vec{Y}
\end{equation}
If we apply the linear chain method, then the solution is given by Equation
\ref{eq:bateman_he}
\begin{equation}\label{eq:bateman_he}
  \begin{aligned}
  N_{i}(t) = &\sum_{j=1}^{i} N_{j}(0)
  \Bigg[ \Bigg( \prod_{k=j}^{i-1} P_{k} \Bigg)
  \sum_{k=j}^{i}\frac{e^{-d_{k}t}}{\displaystyle \prod_{l=j, \neq k}^{i}
  (d_{l} -d_{k})}
  \Bigg] + &&\\
  &\sum_{j=1}^{i} Y_{j} \Bigg[ \Bigg(\prod_{k=j}^{i-1} P_{k} \Bigg)
  \Bigg(\sum_{k=j}^{i} \frac{1}{\displaystyle \prod_{m=j}^{i} d_{m}} -
  \sum_{k=j}^{i} \frac{e^{-d_{k}t}}{d_{k} \displaystyle \prod_{l=j, \neq k}^{i}(d_{l} -d_{k})}
  \Bigg)\Bigg]
  \end{aligned}
\end{equation}
%%
Another version
\begin{equation}\label{eq:bateman_he_2}
  N_{i}(t) = \sum_{j=1}^{i}
  \Bigg( \prod_{k=j}^{i-1} P_{k} \Bigg)
  \Bigg[ N_{j}(0) \Bigg(\sum_{k=j}^{i}\frac{e^{-d_{k}t}}{\displaystyle
  \prod_{l=j, \neq k}^{i}(d_{l} -d_{k})}
  \Bigg) + Y_{j}
  \Bigg( \frac{1}{\displaystyle \prod_{m=j}^{i} d_{m}} -
  \sum_{k=j}^{i} \frac{e^{-d_{k}t}}{d_{k}
  \displaystyle \prod_{l=j, \neq k}^{i}(d_{l} -d_{k})}
  \Bigg)\Bigg]
\end{equation}
%%
%%
%% CINDER
Cinder solves this equation with a few simplications. The following identities were used to
simplify the algorithm.
\begin{equation}\label{eq:simplification1}
  \frac{1}{\displaystyle \prod_{m=j}^{i} d_{m}} \equiv
  \sum_{k=j}^{i} \frac{1}{d_{k}
  \displaystyle \prod_{ l=j, \neq k}^{i}(d_{l} -d_{k})}
\end{equation}
%%
\begin{equation}\label{eq:simplification2}
  \sum_{k=j}^{i} \frac{1}{
  \displaystyle \prod_{l=j, \neq k}^{i}(d_{l} -d_{k})} \equiv 0
\end{equation}
%%
%%
Equation \ref{eq:bateman_he2} is reduced to
\begin{equation}\label{eq:bateman_he_simp}
  N_{i}(t) = \sum_{j=1}^{i}
  \Bigg( \prod_{k=j}^{i-1} P_{k} \Bigg)
  \Bigg[ N_{j}(0) \sum_{k=j}^{i}\frac{e^{-d_{k}t}}{\displaystyle
  \prod_{l=j, \neq k}^{i}(d_{l} -d_{k})}
  + Y_{j}
  \sum_{k=j}^{i} \frac{1 - e^{-d_{k}t}}{d_{k}
  \displaystyle \prod_{l=j, \neq k}^{i}(d_{l} -d_{k})}
  \Bigg]
\end{equation}
CINDER90 made it so that there is no need for predefined set
of linear chains. It tests each transmutation step for significance and
constructs the sequences to be calculated. In order to limit the length
of the chains followed, the algorithm only propagates the
initial density and constant production rate to the first nuclide in the sequence.
\begin{equation}\label{eq:bateman_he_1st_n}
  N_{i}(t) =
  \Bigg( \prod_{k=1}^{i-1} P_{k} \Bigg)
  \Bigg[ N_{1}(0) \sum_{k=1}^{i}\frac{e^{-d_{k}t}}{\displaystyle
  \prod_{l=1, \neq k}^{i}(d_{l} -d_{k})}
  + Y_{1}
  \sum_{k=1}^{i} \frac{1 - e^{-d_{k}t}}{d_{k}
  \displaystyle \prod_{l=1, \neq k}^{i}(d_{l} -d_{k})}
  \Bigg]
\end{equation}
%%
%%
which can be written as
\begin{equation}\label{eq:bateman_he_1st_n2}
  N_{i}(t) = \sum_{j=1}^{i}
  \Bigg[ \frac{N_{1}(0) \displaystyle \prod_{k=1}^{i-1} P_{k}}
  {\displaystyle \prod_{k=1, \neq j}^{i}(d_{k} -d_{j})} \Bigg]e^{-d_{j}t} +
  \sum_{j=1}^{i}
  \Bigg [ \frac{Y_{1} \displaystyle \prod_{k=1}^{i-1} P_{k}}
  {\displaystyle \prod_{k=1, \neq j}^{i}(d_{k} -d_{j})} \Bigg]
  \Bigg( \frac{1 - e^{-d_{j}t}}{d_{j}} \Bigg)
\end{equation}
